<!DOCTYPE html>
<html>
<head>
    <title>Cognito Login Test</title>
    <!-- Load Amplify from CDN with proper integrity check -->
    <script src="https://cdn.jsdelivr.net/npm/aws-amplify@5.3.10/dist/aws-amplify.min.js"
            integrity="sha384-9i6VgG+JQ2Qy0JkR0Qy0YFQ2Z9zU11fFz7OqX9L+5nw5Z5g5f5f5f5f5f5f5f5f5"
            crossorigin="anonymous"></script>
</head>
<body>
    <div>
        <h2>Login Test</h2>
        <input id="username" type="text" placeholder="Username">
        <input id="password" type="password" placeholder="Password">
        <button id="loginBtn">Sign In</button>
        <p id="message"></p>
    </div>

    <script>
        // Wait for Amplify to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Configure Amplify
            try {
                window.amplifyConfig = {
                    Auth: {
                        region: 'ap-southeast-2', // Replace with your region
                        userPoolId: 'ap-southeast-2_yJYKaxRIy', // Replace with your user pool ID
                        userPoolWebClientId: '5e6bndcs0tvos87fndb63urr92' // Replace with your client ID
                    }
                };
                
                Amplify.configure(window.amplifyConfig);
                
                // Set up login button
                document.getElementById('loginBtn').addEventListener('click', signIn);
                
            } catch (configError) {
                document.getElementById('message').textContent = "Failed to initialize authentication";
                console.error("Configuration error:", configError);
            }
        });

        async function signIn() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const messageEl = document.getElementById('message');
            
            messageEl.textContent = "Signing in...";
            messageEl.style.color = "black";

            try {
                const user = await Amplify.Auth.signIn(username, password);
                messageEl.textContent = `Success! Welcome ${user.username}`;
                messageEl.style.color = "green";
                console.log("Authenticated user:", user);
            } catch (error) {
                messageEl.textContent = `Error: ${error.message}`;
                messageEl.style.color = "red";
                console.error("Login error:", error);
            }
        }
    </script>
</body>
</html>
