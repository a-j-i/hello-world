<input type="file" id="fileInput" />
<button onclick="uploadFile()">Upload File</button>

<script>
  async function uploadFile() {
    const fileInput = document.getElementById("fileInput");
    const file = fileInput.files[0];
    
    if (!file) {
      alert("Please select a file to upload.");
      return;
    }

    // Request a pre-signed URL from the Lambda API
    const response = await fetch("https://8n4qwlw0qf.execute-api.ap-southeast-2.amazonaws.com/dev", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ fileName: file.name })
    });

    const data = await response.json();

    if (response.ok) {
      const uploadUrl = data.url; // Get the pre-signed URL from Lambda response

      // Now use this URL to upload the file directly to S3
      const uploadResponse = await fetch(uploadUrl, {
        method: 'PUT',
        headers: {
          'Content-Type': file.type // You may need to set the correct MIME type
        },
        body: file
      });

      if (uploadResponse.ok) {
        alert('File uploaded successfully!');
      } else {
        alert('Failed to upload file.');
      }
    } else {
      alert(`Error: ${data.error}`);
    }
  }
</script>
